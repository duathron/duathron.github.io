---
title: TryHackMe – IDOR
date: 2025-02-12 11:23:09 +0100
categories:
  - Writeups
  - TryHackMe
tags:
  - idor
  - easy
published: true
image:
  path: /assets/img/posts/idor/cover.jpg
  alt: IDOR
---

## Overview

| Field | Details |
|-------|---------|
| Platform | TryHackMe |
| Room/Machine | IDOR |
| Difficulty | Easy |
| Tags | idor, web, api, enumeration |

This room introduces **Insecure Direct Object Reference (IDOR)** — a vulnerability that occurs when an application exposes internal object references (like database IDs) directly to the user without proper access control checks. The room walks you through recognising IDOR opportunities by manually inspecting page source, response headers, and API calls. No special tooling required: a browser and DevTools are enough.

---

## Theory

### What is IDOR? (Task 1)

IDOR stands for **Insecure Direct Object Reference** and is a type of access control vulnerability. It occurs when a web server uses user-supplied input to retrieve objects — files, data, documents — without validating on the server side that the requested object actually belongs to the user requesting it. Too much trust is placed in the client.

### Where are IDORs Located? (Task 6)

The vulnerable endpoint isn't always visible in the address bar. IDORs can appear in:

- **AJAX requests** loaded in the background — visible in the Network tab of DevTools
- **JavaScript files** that reference internal endpoints
- **Hidden parameters** that were used during development and never removed from production (parameter mining). For example, `/user/details` might look safe, but appending `?user_id=123` could expose another user's data entirely.

### How are Object References Disguised? (Tasks 3–5)

Developers sometimes try to obscure IDs to make enumeration harder. These are the three most common patterns — and why none of them are a real security measure:

**Encoded IDs (Task 3):** Data is often base64-encoded before being passed between pages via query strings, POST data, or cookies. Base64 is immediately recognisable by its `a-z, A-Z, 0-9, +, /, =` character set. Decoding, modifying, and re-encoding the value is trivial using tools like [base64decode.org](https://www.base64decode.org/) and [base64encode.org](https://www.base64encode.org/).

**Hashed IDs (Task 4):** IDs are sometimes hashed — for example, the integer `123` becomes `202cb962ac59075b964b07152d234b70` under MD5. This looks opaque, but hashes of small sequential integers are well-known and can be looked up instantly via services like [CrackStation](https://crackstation.net/). The room's practical machine uses this exact pattern: a customer ID that appears as an MD5 hash is still trivially sequenceable.

**Unpredictable IDs (Task 5):** If an ID can't be decoded or cracked, a reliable detection method is to create two accounts and swap their IDs. If account A can access account B's data using B's ID (or vice versa), an IDOR exists. This requires a minimum of **two accounts**.

---

## Warm-up Exercise (Task 2)

Before the main machine, the room provides a small practice website to illustrate the concept hands-on. The scenario: you're looking at a fictional webshop inbox showing order confirmation emails. Clicking on an order confirmation opens an invoice page with a URL like:

```
https://onlinestore.thm/order/1234/invoice
```

The order ID `1234` is embedded directly in the path. Replacing it with `1000` loads a different customer's invoice — no authentication error, no access check. That's IDOR in its simplest form: a numeric identifier in a URL, trusted blindly by the server.

The flag is returned immediately upon accessing the manipulated URL, confirming the vulnerability.

---

## Reconnaissance

This is a purely web-based room with no network scanning involved. The target is a fictional company website called **Acme IT Support**, accessible via the machine's IP or the provided reverse-proxy URL.

### Manual Exploration

The first step is simply opening the site and clicking through every available page: **Home, News, Contact, Customers**. For each page, open the browser's **DevTools** (F12) and check:

- **Elements / Source** – hidden links, comments, hardcoded paths
- **Network** – what requests are fired, what responses come back
- **Response Headers** – sometimes metadata is leaked here

> **Tip:** Developers often leave debug information, hidden links, or test data in places they assume users won't look. Source code review is always worth the two minutes it takes.

---

## Enumeration

### Source Code Review – Home Page

Inspecting the HTML source of the home page reveals a subtly hidden link:

```html
<p class="welcome-msg">Our dedicated staff are ready <a href="/secret-page">to</a> assist you with your IT problems.</p>
```

The word *"to"* is hyperlinked to `/secret-page` — easy to miss visually, but immediately visible in the source. Navigating there yields a flag. This illustrates how **security through obscurity** (hiding something by making it hard to notice, rather than actually restricting access) is not a real access control.

### Response Headers – X-Flag

When loading any page, the **Network tab → Response Headers** shows an `X-Flag` header containing a flag value. This is a classic example of sensitive data being unintentionally leaked through HTTP headers — something that would not be visible to a casual user but is trivially accessible to anyone using DevTools or a proxy.

### Contact Form – AJAX Response Leakage

The `/contact` page contains an input form. After submitting it and watching the **Network tab**, the AJAX response for the `contact_msg` request returns more than just a confirmation:

```json
{"msg": "Message Received", "flag": "THM{...}"}
```

The server is returning a flag embedded in the JSON response body — data the frontend never displays to the user, but which is fully accessible via DevTools. This demonstrates how **API responses can leak data** that the UI intentionally hides.

### Customer Area – Direct API Access

After registering an account and logging in, navigating to *"Your Account"* triggers a network request visible in DevTools:

```
GET /api/v1/customer?id=50
```

The application fetches your profile by passing your numeric user ID directly in the URL as a query parameter. The response looks like:

```json
{"id": 50, "username": "youruser", "email": "you@example.com"}
```

<img src="/assets/img/posts/idor/devtools.png" alt="customer id revealed in DevTools" width="700">

This is the core IDOR vulnerability: the server trusts the client-supplied `id` parameter without verifying that the requesting user is actually authorised to view that record.

---

## Exploitation

### IDOR via API Parameter Manipulation

With the API endpoint identified, exploitation is trivial: manually change the `id` parameter in the browser address bar and observe the response.

```
GET /api/v1/customer?id=2
```

Response:
```json
{"id": 2, "username": "test-account", "email": "test@test.thm"}
```

```
GET /api/v1/customer?id=4
```

Response:
```json
{"id": 4, "username": "simon", "email": "simon22@fakemail.thm"}
```

No authentication error. No access control check. Any authenticated user can retrieve any other user's data simply by iterating through IDs.

> **Note:** The two IDs required to answer the room's questions are not shown here — you'll find them quickly by trying a few values around the ones demonstrated above.

The two specific IDs requested by the room's questions yield the answers needed to complete the challenge.

### Tools Used

The entire room was completed using only **Google Chrome with DevTools** — no specialised security tools required. This is a deliberate design choice of the room to emphasise that IDOR vulnerabilities are often exploitable with nothing more than a browser.

### Going Further (Beyond the Room Scope)

In a real-world scenario or a more advanced exercise, the enumeration of all user IDs could be automated:

**Burp Suite** – Intercept the API request and send it to the Intruder. Use a numeric payload list to iterate over `id=1` through `id=N` and collect all responses.

**ffuf** – Fuzz the ID parameter directly from the command line and write results to a file:

```bash
ffuf -u "http://MACHINE_IP/api/v1/customer?id=FUZZ" \
     -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt \
     -H "Cookie: session=YOUR_SESSION_COOKIE" \
     -o results.json
```



---

## Flags

Flags are intentionally omitted to avoid turning this writeup into a copy-paste solution. The room contains multiple flags discoverable through the steps above. The key insight is *where* to look, not *what* the flag value is.

---

## Lessons Learned

**Enumeration starts with your eyes open.** Reading page source and watching network traffic costs nothing and often reveals the vulnerability immediately. Don't skip the basics in favour of running tools.

**Obscurity is not access control.** A hidden link, a non-displayed header value, or a JSON field that the UI doesn't render — none of these are security mechanisms. If the data reaches the client, the client can read it.

**Numeric sequential IDs are a red flag — and so are hashed ones.** Whenever you see `?id=50` or `/user/50`, ask: what happens at `?id=1`? If the answer is "someone else's data", that's IDOR. A common misconception is that replacing a plain integer with a hash (e.g. the MD5 of `50` is `7f3f5b3e...`) adds security. It doesn't — the hash is still deterministic and trivially computable for any sequential value, making enumeration just as easy. Modern applications should use non-guessable identifiers (e.g. UUIDs) *combined* with server-side authorisation checks — one without the other is not sufficient.

**API endpoints deserve extra scrutiny.** The frontend may only show you your own profile, but the underlying API might be returning data for any ID you ask for. Always check what the API actually responds with, not just what the UI displays.

---

## References

- [OWASP – Broken Access Control (A01:2021)](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
- [OWASP – IDOR](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References)
- [PortSwigger – IDOR](https://portswigger.net/web-security/access-control/idor)
- [TryHackMe Room](https://tryhackme.com/room/idor)
